{"version":3,"sources":["../src/schema.ts"],"sourcesContent":["import { pgTable, text, serial, integer, boolean, timestamp, json, jsonb, varchar, uuid, index } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { sql } from \"drizzle-orm\";\n\nexport const users = pgTable('users', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  email: text('email').notNull().unique(),\n  displayName: text('display_name'),\n  photoURL: text('photo_url'),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  onboardingCompleted: boolean(\"onboarding_completed\").default(false),\n  currentTutorialStep: integer(\"current_tutorial_step\").default(0),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const spots = pgTable('spots', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  name: text('name').notNull(),\n  geo: jsonb('geo').notNull(),\n  createdBy: uuid('created_by').notNull().references(() => users.id),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport const challenges = pgTable('challenges', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  createdBy: uuid('created_by').notNull().references(() => users.id),\n  status: text('status').notNull(),\n  rules: jsonb('rules').notNull(),\n  clipA: text('clip_a').notNull(),\n  clipB: text('clip_b'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport const checkIns = pgTable('check_ins', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  uid: uuid('uid').notNull().references(() => users.id),\n  spotId: uuid('spot_id').notNull().references(() => spots.id),\n  proofVideoUrl: text('proof_video_url'),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: json(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => ({\n    expireIdx: index(\"IDX_session_expire\").on(table.expire),\n  }),\n);\n\nexport const tutorialSteps = pgTable(\"tutorial_steps\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  type: text(\"type\").notNull(),\n  content: json(\"content\").$type<{\n    videoUrl?: string;\n    interactiveElements?: Array<{\n      type: 'tap' | 'swipe' | 'drag';\n      target: string;\n      instruction: string;\n    }>;\n    challengeData?: {\n      action: string;\n      expectedResult: string;\n    };\n  }>(),\n  order: integer(\"order\").notNull(),\n  isActive: boolean(\"is_active\").default(true),\n});\n\nexport const userProgress = pgTable(\"user_progress\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\").notNull(),\n  stepId: integer(\"step_id\").notNull(),\n  completed: boolean(\"completed\").default(false),\n  completedAt: timestamp(\"completed_at\"),\n  timeSpent: integer(\"time_spent\"),\n  interactionData: json(\"interaction_data\").$type<{\n    taps?: number;\n    swipes?: number;\n    mistakes?: number;\n    helpUsed?: boolean;\n  }>(),\n});\n\nexport const subscribers = pgTable(\"subscribers\", {\n  id: serial(\"id\").primaryKey(),\n  firstName: text(\"first_name\"),\n  email: text(\"email\").notNull().unique(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  isActive: boolean(\"is_active\").default(true),\n});\n\nexport const donations = pgTable(\"donations\", {\n  id: serial(\"id\").primaryKey(),\n  firstName: varchar(\"first_name\", { length: 50 }).notNull(),\n  amount: integer(\"amount\").notNull(),\n  paymentIntentId: varchar(\"payment_intent_id\", { length: 255 }).notNull().unique(),\n  status: varchar(\"status\", { length: 50 }).notNull().default(\"pending\"),\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).defaultNow().notNull(),\n});\n\nexport const customUsers = pgTable(\"custom_users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\", { length: 255 }).notNull().unique(),\n  passwordHash: varchar(\"password_hash\", { length: 255 }).notNull(),\n  firstName: varchar(\"first_name\", { length: 100 }),\n  lastName: varchar(\"last_name\", { length: 100 }),\n  firebaseUid: varchar(\"firebase_uid\", { length: 128 }).unique(),\n  isEmailVerified: boolean(\"is_email_verified\").default(false),\n  emailVerificationToken: varchar(\"email_verification_token\", { length: 255 }),\n  emailVerificationExpires: timestamp(\"email_verification_expires\"),\n  resetPasswordToken: varchar(\"reset_password_token\", { length: 255 }),\n  resetPasswordExpires: timestamp(\"reset_password_expires\"),\n  isActive: boolean(\"is_active\").default(true),\n  lastLoginAt: timestamp(\"last_login_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const authSessions = pgTable(\"auth_sessions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => customUsers.id, { onDelete: 'cascade' }),\n  token: varchar(\"token\", { length: 255 }).notNull().unique(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const feedback = pgTable(\"feedback\", {\n  id: serial(\"id\").primaryKey(),\n  userId: varchar(\"user_id\"),\n  userEmail: varchar(\"user_email\", { length: 255 }),\n  type: varchar(\"type\", { length: 50 }).notNull(),\n  message: text(\"message\").notNull(),\n  status: varchar(\"status\", { length: 50 }).notNull().default(\"new\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const insertTutorialStepSchema = createInsertSchema(tutorialSteps).omit({\n  id: true,\n});\n\nexport const insertUserProgressSchema = createInsertSchema(userProgress).omit({\n  id: true,\n  completedAt: true,\n});\n\nexport const updateUserProgressSchema = createInsertSchema(userProgress).pick({\n  completed: true,\n  timeSpent: true,\n  interactionData: true,\n});\n\nexport const insertSubscriberSchema = createInsertSchema(subscribers).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertDonationSchema = createInsertSchema(donations);\n\nexport const insertFeedbackSchema = createInsertSchema(feedback).omit({\n  id: true,\n  createdAt: true,\n  status: true,\n});\n\nexport type User = typeof users.$inferSelect;\nexport type UpsertUser = typeof users.$inferInsert;\nexport type Spot = typeof spots.$inferSelect;\nexport type InsertSpot = typeof spots.$inferInsert;\nexport type Challenge = typeof challenges.$inferSelect;\nexport type InsertChallenge = typeof challenges.$inferInsert;\nexport type CheckIn = typeof checkIns.$inferSelect;\nexport type InsertCheckIn = typeof checkIns.$inferInsert;\nexport type TutorialStep = typeof tutorialSteps.$inferSelect;\nexport type InsertTutorialStep = typeof insertTutorialStepSchema._type;\nexport type UserProgress = typeof userProgress.$inferSelect;\nexport type InsertUserProgress = typeof insertUserProgressSchema._type;\nexport type UpdateUserProgress = typeof updateUserProgressSchema._type;\nexport type Subscriber = typeof subscribers.$inferSelect;\nexport type InsertSubscriber = typeof insertSubscriberSchema._type;\nexport type Donation = typeof donations.$inferSelect;\nexport type InsertDonation = typeof insertDonationSchema._type;\nexport type CustomUser = typeof customUsers.$inferSelect;\nexport type InsertCustomUser = typeof customUsers.$inferInsert;\nexport type AuthSession = typeof authSessions.$inferSelect;\nexport type InsertAuthSession = typeof authSessions.$inferInsert;\nexport type Feedback = typeof feedback.$inferSelect;\nexport type InsertFeedback = typeof insertFeedbackSchema._type;\n"],"mappings":";AAAA,SAAS,SAAS,MAAM,QAAQ,SAAS,SAAS,WAAW,MAAM,OAAO,SAAS,MAAM,aAAa;AACtG,SAAS,0BAA0B;AACnC,SAAS,WAAW;AAEb,IAAM,QAAQ,QAAQ,SAAS;AAAA,EACpC,IAAI,KAAK,IAAI,EAAE,WAAW,EAAE,cAAc;AAAA,EAC1C,OAAO,KAAK,OAAO,EAAE,QAAQ,EAAE,OAAO;AAAA,EACtC,aAAa,KAAK,cAAc;AAAA,EAChC,UAAU,KAAK,WAAW;AAAA,EAC1B,WAAW,QAAQ,YAAY;AAAA,EAC/B,UAAU,QAAQ,WAAW;AAAA,EAC7B,iBAAiB,QAAQ,mBAAmB;AAAA,EAC5C,qBAAqB,QAAQ,sBAAsB,EAAE,QAAQ,KAAK;AAAA,EAClE,qBAAqB,QAAQ,uBAAuB,EAAE,QAAQ,CAAC;AAAA,EAC/D,WAAW,UAAU,YAAY,EAAE,WAAW,EAAE,QAAQ;AAAA,EACxD,WAAW,UAAU,YAAY,EAAE,WAAW;AAChD,CAAC;AAEM,IAAM,QAAQ,QAAQ,SAAS;AAAA,EACpC,IAAI,KAAK,IAAI,EAAE,WAAW,EAAE,cAAc;AAAA,EAC1C,MAAM,KAAK,MAAM,EAAE,QAAQ;AAAA,EAC3B,KAAK,MAAM,KAAK,EAAE,QAAQ;AAAA,EAC1B,WAAW,KAAK,YAAY,EAAE,QAAQ,EAAE,WAAW,MAAM,MAAM,EAAE;AAAA,EACjE,WAAW,UAAU,YAAY,EAAE,WAAW,EAAE,QAAQ;AAC1D,CAAC;AAEM,IAAM,aAAa,QAAQ,cAAc;AAAA,EAC9C,IAAI,KAAK,IAAI,EAAE,WAAW,EAAE,cAAc;AAAA,EAC1C,WAAW,KAAK,YAAY,EAAE,QAAQ,EAAE,WAAW,MAAM,MAAM,EAAE;AAAA,EACjE,QAAQ,KAAK,QAAQ,EAAE,QAAQ;AAAA,EAC/B,OAAO,MAAM,OAAO,EAAE,QAAQ;AAAA,EAC9B,OAAO,KAAK,QAAQ,EAAE,QAAQ;AAAA,EAC9B,OAAO,KAAK,QAAQ;AAAA,EACpB,WAAW,UAAU,YAAY,EAAE,WAAW,EAAE,QAAQ;AAC1D,CAAC;AAEM,IAAM,WAAW,QAAQ,aAAa;AAAA,EAC3C,IAAI,KAAK,IAAI,EAAE,WAAW,EAAE,cAAc;AAAA,EAC1C,KAAK,KAAK,KAAK,EAAE,QAAQ,EAAE,WAAW,MAAM,MAAM,EAAE;AAAA,EACpD,QAAQ,KAAK,SAAS,EAAE,QAAQ,EAAE,WAAW,MAAM,MAAM,EAAE;AAAA,EAC3D,eAAe,KAAK,iBAAiB;AAAA,EACrC,WAAW,UAAU,YAAY,EAAE,WAAW,EAAE,QAAQ;AAC1D,CAAC;AAEM,IAAM,WAAW;AAAA,EACtB;AAAA,EACA;AAAA,IACE,KAAK,QAAQ,KAAK,EAAE,WAAW;AAAA,IAC/B,MAAM,KAAK,MAAM,EAAE,QAAQ;AAAA,IAC3B,QAAQ,UAAU,QAAQ,EAAE,QAAQ;AAAA,EACtC;AAAA,EACA,CAAC,WAAW;AAAA,IACV,WAAW,MAAM,oBAAoB,EAAE,GAAG,MAAM,MAAM;AAAA,EACxD;AACF;AAEO,IAAM,gBAAgB,QAAQ,kBAAkB;AAAA,EACrD,IAAI,OAAO,IAAI,EAAE,WAAW;AAAA,EAC5B,OAAO,KAAK,OAAO,EAAE,QAAQ;AAAA,EAC7B,aAAa,KAAK,aAAa,EAAE,QAAQ;AAAA,EACzC,MAAM,KAAK,MAAM,EAAE,QAAQ;AAAA,EAC3B,SAAS,KAAK,SAAS,EAAE,MAWtB;AAAA,EACH,OAAO,QAAQ,OAAO,EAAE,QAAQ;AAAA,EAChC,UAAU,QAAQ,WAAW,EAAE,QAAQ,IAAI;AAC7C,CAAC;AAEM,IAAM,eAAe,QAAQ,iBAAiB;AAAA,EACnD,IAAI,OAAO,IAAI,EAAE,WAAW;AAAA,EAC5B,QAAQ,QAAQ,SAAS,EAAE,QAAQ;AAAA,EACnC,QAAQ,QAAQ,SAAS,EAAE,QAAQ;AAAA,EACnC,WAAW,QAAQ,WAAW,EAAE,QAAQ,KAAK;AAAA,EAC7C,aAAa,UAAU,cAAc;AAAA,EACrC,WAAW,QAAQ,YAAY;AAAA,EAC/B,iBAAiB,KAAK,kBAAkB,EAAE,MAKvC;AACL,CAAC;AAEM,IAAM,cAAc,QAAQ,eAAe;AAAA,EAChD,IAAI,OAAO,IAAI,EAAE,WAAW;AAAA,EAC5B,WAAW,KAAK,YAAY;AAAA,EAC5B,OAAO,KAAK,OAAO,EAAE,QAAQ,EAAE,OAAO;AAAA,EACtC,WAAW,UAAU,YAAY,EAAE,WAAW;AAAA,EAC9C,UAAU,QAAQ,WAAW,EAAE,QAAQ,IAAI;AAC7C,CAAC;AAEM,IAAM,YAAY,QAAQ,aAAa;AAAA,EAC5C,IAAI,OAAO,IAAI,EAAE,WAAW;AAAA,EAC5B,WAAW,QAAQ,cAAc,EAAE,QAAQ,GAAG,CAAC,EAAE,QAAQ;AAAA,EACzD,QAAQ,QAAQ,QAAQ,EAAE,QAAQ;AAAA,EAClC,iBAAiB,QAAQ,qBAAqB,EAAE,QAAQ,IAAI,CAAC,EAAE,QAAQ,EAAE,OAAO;AAAA,EAChF,QAAQ,QAAQ,UAAU,EAAE,QAAQ,GAAG,CAAC,EAAE,QAAQ,EAAE,QAAQ,SAAS;AAAA,EACrE,WAAW,UAAU,cAAc,EAAE,cAAc,KAAK,CAAC,EAAE,WAAW,EAAE,QAAQ;AAClF,CAAC;AAEM,IAAM,cAAc,QAAQ,gBAAgB;AAAA,EACjD,IAAI,QAAQ,IAAI,EAAE,WAAW,EAAE,QAAQ,sBAAsB;AAAA,EAC7D,OAAO,QAAQ,SAAS,EAAE,QAAQ,IAAI,CAAC,EAAE,QAAQ,EAAE,OAAO;AAAA,EAC1D,cAAc,QAAQ,iBAAiB,EAAE,QAAQ,IAAI,CAAC,EAAE,QAAQ;AAAA,EAChE,WAAW,QAAQ,cAAc,EAAE,QAAQ,IAAI,CAAC;AAAA,EAChD,UAAU,QAAQ,aAAa,EAAE,QAAQ,IAAI,CAAC;AAAA,EAC9C,aAAa,QAAQ,gBAAgB,EAAE,QAAQ,IAAI,CAAC,EAAE,OAAO;AAAA,EAC7D,iBAAiB,QAAQ,mBAAmB,EAAE,QAAQ,KAAK;AAAA,EAC3D,wBAAwB,QAAQ,4BAA4B,EAAE,QAAQ,IAAI,CAAC;AAAA,EAC3E,0BAA0B,UAAU,4BAA4B;AAAA,EAChE,oBAAoB,QAAQ,wBAAwB,EAAE,QAAQ,IAAI,CAAC;AAAA,EACnE,sBAAsB,UAAU,wBAAwB;AAAA,EACxD,UAAU,QAAQ,WAAW,EAAE,QAAQ,IAAI;AAAA,EAC3C,aAAa,UAAU,eAAe;AAAA,EACtC,WAAW,UAAU,YAAY,EAAE,WAAW,EAAE,QAAQ;AAAA,EACxD,WAAW,UAAU,YAAY,EAAE,WAAW,EAAE,QAAQ;AAC1D,CAAC;AAEM,IAAM,eAAe,QAAQ,iBAAiB;AAAA,EACnD,IAAI,QAAQ,IAAI,EAAE,WAAW,EAAE,QAAQ,sBAAsB;AAAA,EAC7D,QAAQ,QAAQ,SAAS,EAAE,QAAQ,EAAE,WAAW,MAAM,YAAY,IAAI,EAAE,UAAU,UAAU,CAAC;AAAA,EAC7F,OAAO,QAAQ,SAAS,EAAE,QAAQ,IAAI,CAAC,EAAE,QAAQ,EAAE,OAAO;AAAA,EAC1D,WAAW,UAAU,YAAY,EAAE,QAAQ;AAAA,EAC3C,WAAW,UAAU,YAAY,EAAE,WAAW,EAAE,QAAQ;AAC1D,CAAC;AAEM,IAAM,WAAW,QAAQ,YAAY;AAAA,EAC1C,IAAI,OAAO,IAAI,EAAE,WAAW;AAAA,EAC5B,QAAQ,QAAQ,SAAS;AAAA,EACzB,WAAW,QAAQ,cAAc,EAAE,QAAQ,IAAI,CAAC;AAAA,EAChD,MAAM,QAAQ,QAAQ,EAAE,QAAQ,GAAG,CAAC,EAAE,QAAQ;AAAA,EAC9C,SAAS,KAAK,SAAS,EAAE,QAAQ;AAAA,EACjC,QAAQ,QAAQ,UAAU,EAAE,QAAQ,GAAG,CAAC,EAAE,QAAQ,EAAE,QAAQ,KAAK;AAAA,EACjE,WAAW,UAAU,YAAY,EAAE,WAAW,EAAE,QAAQ;AAC1D,CAAC;AAEM,IAAM,2BAA2B,mBAAmB,aAAa,EAAE,KAAK;AAAA,EAC7E,IAAI;AACN,CAAC;AAEM,IAAM,2BAA2B,mBAAmB,YAAY,EAAE,KAAK;AAAA,EAC5E,IAAI;AAAA,EACJ,aAAa;AACf,CAAC;AAEM,IAAM,2BAA2B,mBAAmB,YAAY,EAAE,KAAK;AAAA,EAC5E,WAAW;AAAA,EACX,WAAW;AAAA,EACX,iBAAiB;AACnB,CAAC;AAEM,IAAM,yBAAyB,mBAAmB,WAAW,EAAE,KAAK;AAAA,EACzE,IAAI;AAAA,EACJ,WAAW;AACb,CAAC;AAEM,IAAM,uBAAuB,mBAAmB,SAAS;AAEzD,IAAM,uBAAuB,mBAAmB,QAAQ,EAAE,KAAK;AAAA,EACpE,IAAI;AAAA,EACJ,WAAW;AAAA,EACX,QAAQ;AACV,CAAC;","names":[]}