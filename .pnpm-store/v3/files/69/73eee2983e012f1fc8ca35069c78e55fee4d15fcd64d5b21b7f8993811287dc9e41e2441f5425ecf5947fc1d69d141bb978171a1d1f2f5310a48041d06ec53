"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ReactNativeStartupInstrumentation = void 0;
var _NativeHoneycombOpentelemetryReactNative = _interopRequireDefault(require("./NativeHoneycombOpentelemetryReactNative"));
var _instrumentation = require("@opentelemetry/instrumentation");
var _version = require("./version.js");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
const LIBRARY_NAME = '@honeycombio/app-startup';
/**
 * Emit a span with the total time from when the app was started to when this was called.
 */
class ReactNativeStartupInstrumentation extends _instrumentation.InstrumentationBase {
  constructor({
    enabled = true
  } = {}) {
    const config = {
      enabled
    };
    super(LIBRARY_NAME, _version.VERSION, config);
    this._isEnabled = enabled;
  }
  enable() {
    if (this._isEnabled) {
      this._diag.debug('Instrumentation already enabled');
    }
    this._isEnabled = true;
  }
  disable() {
    if (!this._isEnabled) {
      this._diag.debug('Instrumentation already disabled');
    }
    this._isEnabled = false;
  }
  init() {}

  /**
   * Sets TracerProvider to this plugin
   * @param tracerProvider
   */
  setTracerProvider(tracerProvider) {
    super.setTracerProvider(tracerProvider);
    if (this._isEnabled) {
      this.sendAppStartTrace();
    }
  }
  sendAppStartTrace() {
    let startTime = _NativeHoneycombOpentelemetryReactNative.default.getAppStartTime();
    this.tracer.startSpan('react native startup', {
      startTime
    }).end();
  }
}
exports.ReactNativeStartupInstrumentation = ReactNativeStartupInstrumentation;
//# sourceMappingURL=ReactNativeStartupInstrumentation.js.map