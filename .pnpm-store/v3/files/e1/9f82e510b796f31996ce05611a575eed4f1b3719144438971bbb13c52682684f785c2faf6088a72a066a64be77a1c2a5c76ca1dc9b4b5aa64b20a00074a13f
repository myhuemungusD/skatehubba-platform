"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.NavigationInstrumentation = NavigationInstrumentation;
var _api = require("@opentelemetry/api");
var _react = require("react");
var _jsxRuntime = require("react/jsx-runtime");
const LIBRARY_NAME = '@honeycombio/navigation';
function NavigationInstrumentation({
  ref,
  children
}) {
  const routeNameRef = (0, _react.useRef)(undefined);
  (0, _react.useEffect)(() => {
    if (!ref || !ref.isReady()) {
      return;
    }
    ref.addListener('state', () => {
      const timestamp = Date.now();
      const previousRoute = routeNameRef.current;
      const {
        name: currentRoute
      } = ref.getCurrentRoute() ?? {};
      if (currentRoute) {
        _api.trace.getTracer(LIBRARY_NAME).startSpan('screen appeared', {
          startTime: timestamp
        }).setAttribute('screen.route', currentRoute).end();
      }
      if (previousRoute) {
        _api.trace.getTracer(LIBRARY_NAME).startSpan('screen disappeared', {
          startTime: timestamp
        }).setAttribute('screen.route', previousRoute).end();
      }
    });
  }, [ref]);
  return /*#__PURE__*/(0, _jsxRuntime.jsx)(_jsxRuntime.Fragment, {
    children: children
  });
}
//# sourceMappingURL=NavigationInstrumentation.js.map